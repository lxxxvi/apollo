.flex
  .mb-10= link_to 'Back to poll', poll_path(@poll), class: 'shy-link'

%h1.mb-10 Manage poll

.information-section.my-16
  .flex
    .w-full
      %h2.border-0.border-gray-200.border-b.text-gray-600 Information
      .pt-5.px-2
        .flex.-mx-2
          .text-gray-500.pr-2.pt-4{ class: 'w-1/3' }
            = raw "Information can no longer be changed as soon as the poll #{colorize_text('starts', :started)}."
          %div.pl-2{ class: 'w-2/3' }= render 'form', form: PollForm.new(@poll, @poll.slice(:title, :description))

.checklist-section
  .flex
    .w-full
      %h2.border-0.border-gray-200.border-b.text-gray-600 Checklist
  .flex.flex-wrap.mt-4
    .w-full
      .flex.flex-wrap.my-2.border-0.border-apollo-teal-300.pl-4.border-l-8
        .w-full.text-xl
          = colorize_text("Verify email address", :draft)
        .w-full.text-gray-600.my-1.text-sm
          = raw "In order to #{colorize_text('publish', :published)} the poll, you need to verify your email address that we have sent during registration."
    .w-full
      .flex.flex-wrap.my-2.border-0.border-apollo-teal-300.pl-4.border-l-8
        .w-full.text-xl
          = colorize_text("Add nominees", :draft)
        .w-full.text-gray-600.my-1.text-sm
          A poll should have at least 1 nominee.
    .w-full
      .flex.flex-wrap.my-2.border-0.border-apollo-teal-300.pl-4.border-l-8
        .w-full.text-xl
          = colorize_text("Add tokens", :draft)
        .w-full.text-gray-600.my-1.text-sm
          Tokens are used to anonymously vote for a nominee.
    .w-full
      .flex.flex-wrap.my-2.border-0.border-apollo-violet-300.pl-4.border-l-8
        .w-full.text-xl
          = colorize_text("Publish poll", :published)
        .w-full.text-gray-600.my-1.text-sm
          = raw "Once a poll is #{colorize_text('published', :published)}, holders of a token can preview the nominees but voting is not allowed yet. In this phase you can still add, update or delete nominees and add tokens."
    .w-full
      .flex.flex-wrap.my-2.border-0.border-apollo-green-500.pl-4.border-l-8
        .w-full.text-xl
          = colorize_text("Start poll", :started)
        .w-full.text-gray-600.my-1.text-sm
          = raw "Once a poll is #{colorize_text('started', :started)}, tokens can be used for voting. Any other modification on the poll is no longer allowed."
    .w-full
      .flex.flex-wrap.my-2.border-0.border-apollo-pink-500.pl-4.border-l-8
        .w-full.text-xl
          = colorize_text("Close poll", :closed)
        .w-full.text-gray-600.my-1.text-sm
          = raw "Once a poll is #{colorize_text('closed', :closed)}, voting is no longer possible. The poll is ultimately concluded and the results are final."
    .w-full
      .flex.flex-wrap.my-2.border-0.border-orange-600.pl-4.border-l-8
        .w-full.text-xl
          = colorize_text("Archive poll", :archived)
        .w-full.text-gray-600.my-1.text-sm
          = raw "#{colorize_text('Archived', :archived)} poll will no longer show up in the public list."


.nominees-section.my-16
  .flex
    .w-full
      .flex.border-0.border-gray-200.border-b
        .text-gray-600{ class: 'w-1/2'}
          %h2.text-gray-600 Nominees
        .relative{ class: 'w-1/2'}
          - if policy(@poll).edit?
            = link_to 'Add nominee', new_poll_nominee_path(@poll), class: 'apollo-pink-link absolute bottom-0 right-0'
      .flex
        .w-full.mt-5
          %ul.nominees
            - @poll.nominees.ordered_by_name.each do |nominee|
              %li.nominee
                .mb-10.px-2
                  .flex.-mx-2
                    .text-gray-500.pr-2{ class: 'w-1/3' }
                    .pl-2{ class: 'w-2/3' }
                      .flex.flex-wrap
                        .w-full.text-apollo-pink-500= nominee.name
                        .w-full.mt-1.my-2.text-gray-600.text-sm= nominee.description
                        - if policy(@poll).edit?
                          .w-full.text-sm
                            = link_to 'Edit',
                              edit_poll_nominee_path(@poll, nominee),
                              class: 'shy-link'
                            = link_to 'Delete',
                              poll_nominee_path(@poll, nominee),
                              method: :delete,
                              data: { confirm: 'Are you sure?' },
                              class: 'shy-dangerous-link'

.tokens-section.my-16
  .flex
    .w-full
      .flex.border-0.border-gray-200.border-b
        .text-gray-600{ class: 'w-2/3'}
          %h2 Tokens
        .relative{ class: 'w-1/3'}
          - if policy(@poll).update?
            = link_to 'Add tokens', new_poll_token_path(@poll), class: 'apollo-pink-link absolute bottom-0 right-0'
      .flex
        .w-full
          .pt-5.px-2
            .flex.-mx-2
              .text-gray-500.pr-2{ class: 'w-1/3' }
                Tokens are used to vote.
              .pl-2{ class: 'w-2/3' }
                .flex
                  .w-full= raw "This poll has #{emphasize(pluralize(@poll.tokens.count, 'token'))}."


.delete-section.my-16
  %h2.border-0.border-gray-200.border-b.text-red-700 Delete poll
  .pt-5.px-2
    .flex.-mx-2
      - if @poll.deletable?
        .text-gray-500.pr-2{ class: 'w-1/3' }
          This action cannot be undone.
        .pl-2.text-right{ class: 'w-2/3' }= render 'polls/deletion/form', form: PollDeletionForm.new(@poll)
      - else
        .text-gray-500
          = raw "This poll can no longer be delete since it has been #{colorize_text('started', :started)}."
          = raw "You may archive the poll after it is #{colorize_text('closed', :closed)}."

